# userflow.md

본 문서는 Influencer SaaS 플랫폼의 **기능 단위 유저플로우(User Flow)**를 정의합니다.  
각 플로우는 입력(Input) → 처리(Process) → 출력(Output) 순서로 기술하며, 엣지케이스 대응을 포함합니다.

---

## 1. 회원가입 & 온보딩

### 입력
- 이메일, 비밀번호 입력 및 제출
- 약관 동의 체크
- 역할 선택(광고주 / 인플루언서)
- 공통 정보: 이름, 생년월일, 휴대폰번호
- 광고주 전용: 업체명, 사업자등록번호, 대표자명, 업장 전화번호, 주소
- 인플루언서 전용: SNS 채널명, 채널 링크, 팔로워 수
- 제출 버튼 상호작용

### 처리
1. 클라이언트 단 유효성 검사
2. 서버 계정 생성 요청 (이메일 중복 확인, 비밀번호 정책 확인)
3. 사용자 프로필 생성 (profiles + 역할별 테이블)
4. 역할 기반 권한 설정 및 RLS 정책 연계
5. 세션/토큰 발급, 온보딩 완료 플래그 저장
6. 가입 이벤트 감사 로그 기록
7. 오류 시 롤백 처리

### 출력
- 성공: 세션 상태 확립, 홈/대시보드 접근 가능
- 실패: 필드 단위 에러 표시, 재입력 가능
- 부분 성공: 미완료 단계 복구 안내
- 사이드이펙트: 감사 로그, 메트릭 집계

### 엣지케이스
- 이메일 중복
- 비밀번호 정책 불충족
- 약관 미동의
- 역할 미선택
- 필수 정보 누락
- 네트워크 오류로 인한 중간 실패
- 동일 사용자가 두 역할 연속 생성 시도
- 레이트 리밋, 봇 차단

---

## 2. 캠페인 탐색 & 필터링

### 입력
- 사용자가 홈 화면 접근
- 카테고리 필터 클릭 (맛집/뷰티/여행/생활/문화/디지털)
- 지역 필터 선택 (서울, 인천, 경기, 부산)
- 정렬 옵션 선택 (최신순, 인기순)
- 특정 캠페인 카드 클릭

### 처리
1. 서버에서 모집중인 캠페인 목록 쿼리
2. 카테고리/지역/정렬 조건 반영하여 결과 반환
3. 인기순 처리: 조회수 기준, 지원자수가 모집 정원의 2배 이상인 캠페인 우선
4. 결과 캐싱 및 페이지네이션 처리
5. 로깅: 조회 이벤트 기록

### 출력
- 조건에 맞는 캠페인 카드 리스트 표시
- 캠페인 상세 접근 가능

### 엣지케이스
- 조건에 맞는 캠페인 없음 (빈 리스트 처리)
- 데이터베이스 연결 지연
- 인기순 기준을 만족하는 캠페인 부재
- 사용자가 중복 클릭 시 요청 중복 → 디바운싱 필요

---

## 3. 캠페인 생성 (광고주)

### 입력
- 광고주 대시보드 진입
- 신규 캠페인 등록 클릭
- 캠페인명, 모집기간, 모집인원(capacity), 제공혜택, 매장정보, 미션 입력
- 카테고리, 지역 선택
- 모집 마감 기한 입력
- 등록 버튼 클릭

### 처리
1. 입력값 유효성 검사 (기간, capacity, 혜택 필수)
2. 광고주 권한 검증 (사업자 등록 여부)
3. Campaign 레코드 생성
4. 초기 상태를 OPEN으로 설정
5. 이벤트 로깅

### 출력
- 캠페인 리스트에 신규 캠페인 반영
- 캠페인 상세 페이지 생성

### 엣지케이스
- 사업자 등록 미완료 광고주가 시도
- 모집기간이 과거 날짜
- 모집인원 0명 입력
- 네트워크 오류로 등록 실패

---

## 4. 캠페인 지원 (인플루언서)

### 입력
- 인플루언서가 캠페인 상세 페이지 접근
- 지원하기 버튼 클릭
- 각오 한마디, 방문 예정일 입력
- 제출 버튼 클릭

### 처리
1. 인플루언서 프로필 검증 (정보 등록 여부)
2. 해당 캠페인 중복 지원 여부 확인 (1인 1회 원칙)
3. 방문 예정일이 모집기간 내에 포함되는지 확인
4. Application 레코드 생성 (상태: 신청완료)
5. 이벤트 로깅

### 출력
- 내 지원 목록에 해당 캠페인 추가
- 상태: 신청완료

### 엣지케이스
- 이미 지원한 캠페인 재지원 시도
- 방문일자가 모집기간 외일 경우
- 캠페인이 CLOSED 상태인 경우
- 네트워크 오류

---

## 5. 모집 종료 & 선정 (광고주)

### 입력
- 광고주 대시보드에서 캠페인 상세 접근
- 모집 종료 버튼 클릭 (조기 종료 가능)
- 지원자 리스트 확인
- 선정할 인플루언서 선택
- 대기자 인원 선택 가능
- 선정 완료 버튼 클릭

### 처리
1. 캠페인 상태 확인 (OPEN → CLOSED 전환)
2. 선정 마감 기한 내인지 검증
3. 지원자 중 선택된 인원을 SELECTED 상태로 업데이트
4. 대기자는 WAITLIST 상태로 업데이트
5. 알림 발송 (이메일)
6. 이벤트 로깅

### 출력
- 지원자 상태 업데이트
- 광고주 화면에서 선정 결과 반영

### 엣지케이스
- 모집 정원보다 적게 지원한 경우
- 광고주가 마감일을 넘겨서 선정 시도
- 네트워크 오류로 일부 상태 업데이트 실패

---

## 6. 리뷰 제출 (인플루언서)

### 입력
- 선정된 인플루언서가 대시보드 접근
- 리뷰 제출 버튼 클릭
- 리뷰 URL 입력 후 제출

### 처리
1. 선정된 상태인지 검증
2. URL 형식 유효성 검사
3. Review 레코드 생성
4. 제출 완료 상태로 업데이트
5. 광고주/관리자에게 알림

### 출력
- 리뷰 제출 성공 메시지 표시
- 내 지원 목록에서 리뷰 제출 여부 반영

### 엣지케이스
- URL 형식 오류
- 이미 리뷰 제출한 상태에서 중복 제출 시도
- 선정되지 않은 사용자가 제출 시도
- 네트워크 오류

---
